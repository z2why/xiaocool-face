{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { VEmojiPicker } from 'v-emoji-picker';\nexport default {\n  name: 'Chat',\n  components: {\n    VEmojiPicker\n  },\n  props: {\n    someData: {\n      type: Object,\n      default: \"\"\n    },\n    client: {\n      type: Object,\n      default: null\n    },\n    receiveMsg: {\n      type: String,\n      require: false,\n      default: ''\n    }\n  },\n\n  created() {\n    this.request.get(\"/message/getMsg/\", {\n      params: {\n        meetingId: this.someData.meetingId\n      }\n    }).then(res => {\n      if (res.code === \"200\") {\n        let Msgdata = [];\n\n        for (let i = 0; i < res.data.length; i++) {\n          // if (i===res.data.length-1){\n          // Msgdata[i]=res.data[i].nickname+\":\"+ res.data[i].content}\n          // else {\n          Msgdata[i] = res.data[i].nickname + \":\" + res.data[i].content + \"\\n\"; // }\n        }\n\n        Msgdata = Msgdata.toString().replace(/,/g, \"\");\n        this.recText = Msgdata;\n        this.scrollBottom();\n      } else {\n        this.$message.success(\"ËÅäÂ§©ËÆ∞ÂΩïÂá∫ÈîôÂï¶ÔºÅ\");\n      }\n    });\n  },\n\n  mounted() {\n    window.addEventListener('click', this.handleOutsideClick);\n    this.getScreenSize();\n    console.log(\"someData\", this.someData);\n  },\n\n  data() {\n    return {\n      visible: false,\n      recText: '',\n      sendText: '',\n      row: '',\n      editor: null,\n      screenWidth: '',\n      screenHeight: '',\n      toolbarConfig: {},\n      editorConfig: {\n        placeholder: 'ËØ∑ËæìÂÖ•ÂÜÖÂÆπ...'\n      },\n      mode: 'default' // or 'simple'\n\n    };\n  },\n\n  watch: {\n    receiveMsg: {\n      handler(newVal) {\n        this.receiveMsgHandle(newVal);\n      },\n\n      immediate: true,\n      deep: true\n    }\n  },\n  methods: {\n    getScreenSize() {\n      this.screenWidth = document.body.clientWidth;\n      this.screenHeight = document.body.clientHeight;\n\n      window.onresize = () => {\n        return (() => {\n          this.screenWidth = document.body.clientWidth;\n          this.screenHeight = document.body.clientHeight;\n\n          if (this.screenHeight > 900) {\n            this.row = 21;\n          } else {\n            this.row = 15;\n          }\n        })();\n      };\n\n      if (this.screenHeight > 900) {\n        this.row = 21;\n      } else {\n        this.row = 15;\n      }\n    },\n\n    scrollBottom() {\n      this.$nextTick(() => {\n        setTimeout(() => {\n          const textarea = document.getElementById('textarea_id');\n          textarea.scrollTop = textarea.scrollHeight;\n        }, 13);\n      });\n    },\n\n    handleOutsideClick(event) {\n      // Ëé∑ÂèñÁªÑ‰ª∂ÁöÑÊ†πÂÖÉÁ¥†\n      const container = this.$el; // Âà§Êñ≠ÁÇπÂáª‰∫ã‰ª∂ÁöÑÁõÆÊ†áÊòØÂê¶Âú®ÁªÑ‰ª∂‰ª•Â§ñ\n\n      if (!container.contains(event.target)) {\n        this.closePopover();\n      }\n    },\n\n    closePopover() {\n      this.visible = false;\n    },\n\n    togglePopover() {\n      this.visible = !this.visible;\n    },\n\n    noclosePopover() {\n      this.visible = true;\n    },\n\n    selectEmoji(emoji) {\n      console.log(emoji);\n      var elInput = document.getElementById('emojiInput'); //Ëé∑ÂèñËæìÂÖ•Ê°ÜÂÖÉÁ¥†\n      // console.log(elInput);\n\n      var start = elInput.selectionStart; // ËÆ∞ÂΩïÂÖâÊ†áÂºÄÂßãÁöÑ‰ΩçÁΩÆ\n\n      var end = elInput.selectionEnd; // ËÆ∞ÂΩïÈÄâ‰∏≠ÁöÑÂ≠óÁ¨¶ ÊúÄÂêéÁöÑÂ≠óÁ¨¶ÁöÑ‰ΩçÁΩÆ\n\n      if (start === undefined || end === undefined) return;\n      var txt = elInput.value; // Â∞ÜË°®ÊÉÖÊ∑ªÂä†Âà∞ÈÄâ‰∏≠ÁöÑÂÖâÊ†á‰ΩçÁΩÆ\n\n      var result = txt.substring(0, start) + emoji.data + txt.substring(end);\n      elInput.value = result; // ËµãÂÄºÁªôinputÁöÑvalue\n      // ÈáçÁΩÆÂÖâÊ†á‰ΩçÁΩÆ\n\n      elInput.focus();\n      elInput.selectionStart = start + emoji.data.length;\n      elInput.selectionEnd = start + emoji.data.length;\n      console.log(result);\n      this.sendText = result; // ËµãÂÄº(Ê≥®ÊÑèËøôÈáå‰∏ÄÂÆöË¶ÅËµãÂÄºÁªôË°®ÊÉÖËæìÂÖ•Ê°ÜÁªëÂÆöÁöÑÈÇ£‰∏™ÂÄº)\n    },\n\n    receiveMsgHandle(newVal) {\n      if (newVal && newVal.content) {\n        this.recText += newVal.content;\n        this.scrollBottom();\n      }\n    },\n\n    enterSearch() {\n      document.onkeydown = e => {\n        //13Ë°®‚Ω∞ÂõûËΩ¶ÈîÆÔºåbaseURIÊòØÂΩìÂâçÈ°µ‚æØÁöÑÂú∞ÂùÄÔºå‰∏∫‰∫ÜÊõ¥‰∏•Ë∞®Ôºå‰πüÂèØ‰ª•Âä†Âà´ÁöÑÔºåÂèØ‰ª•ÊâìÂç∞eÁúã‚ºÄ‰∏ã\n        //ÂõûËΩ¶ÂêéÊâß‚æèÊêúÁ¥¢‚ΩÖÊ≥ï\n        this.$emit('chatEvent', this.sendText);\n      };\n    }\n\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AAEA;EACAA,YADA;EAEAC;IACAC;EADA,CAFA;EAKAC;IACAC;MACAC,YADA;MAEAC;IAFA,CADA;IAKAC;MACAF,YADA;MAEAC;IAFA,CALA;IASAE;MACAH,YADA;MAEAI,cAFA;MAGAH;IAHA;EATA,CALA;;EAoBAI;IACA;MACAC;QACAC;MADA;IADA,GAIAC,IAJA,CAIAC;MACA;QACA;;QACA,0CACA;UACA;UACA;UACA;UACAC,qEAJA,CAKA;QAEA;;QACAA;QACA;QACA;MAEA,CAfA,MAgBA;QACA;MACA;IACA,CAxBA;EAyBA,CA9CA;;EAgDAC;IACAC;IACA;IACAC;EAEA,CArDA;;EAsDAC;IACA;MACAC,cADA;MAEAC,WAFA;MAGAC,YAHA;MAIAC,OAJA;MAKAC,YALA;MAMAC,eANA;MAOAC,gBAPA;MAQAC,iBARA;MASAC;QAAAC;MAAA,CATA;MAUAC,eAVA,CAUA;;IAVA;EAYA,CAnEA;;EAqEAC;IACAvB;MACAwB;QACA;MACA,CAHA;;MAIAC,eAJA;MAKAC;IALA;EADA,CArEA;EA+EAC;IACAC;MACA;MACA;;MACAnB;QACA;UACA;UACA;;UACA;YACA;UACA,CAFA,MAGA;YACA;UACA;QACA,CATA;MAUA,CAXA;;MAaA;QACA;MACA,CAFA,MAGA;QACA;MACA;IACA,CAvBA;;IAwBAoB;MACA;QACAC;UACA;UACAC;QACA,CAHA,EAGA,EAHA;MAIA,CALA;IAMA,CA/BA;;IAiCAC;MACA;MACA,2BAFA,CAGA;;MACA;QACA;MACA;IACA,CAxCA;;IAyCAC;MACA;IACA,CA3CA;;IA4CAC;MACA;IACA,CA9CA;;IA+CAC;MACA;IACA,CAjDA;;IAkDAC;MACA1B;MACA,oDAFA,CAEA;MACA;;MACA,mCAJA,CAIA;;MACA,+BALA,CAKA;;MACA;MACA,wBAPA,CAQA;;MACA,aACA2B,yDADA;MAEAC,uBAXA,CAWA;MACA;;MACAA;MACAA;MACAA;MACA5B;MACA,uBAjBA,CAiBA;IAEA,CArEA;;IAsEA6B;MACA;QACA;QACA;MACA;IACA,CA3EA;;IA4EAC;MACAC;QACA;QACA;QAEA;MAEA,CANA;IAOA;;EApFA;AA/EA","names":["name","components","VEmojiPicker","props","someData","type","default","client","receiveMsg","require","created","params","meetingId","then","res","Msgdata","mounted","window","console","data","visible","recText","sendText","row","editor","screenWidth","screenHeight","toolbarConfig","editorConfig","placeholder","mode","watch","handler","immediate","deep","methods","getScreenSize","scrollBottom","setTimeout","textarea","handleOutsideClick","closePopover","togglePopover","noclosePopover","selectEmoji","txt","elInput","receiveMsgHandle","enterSearch","document"],"sourceRoot":"src/views/meeting/components","sources":["Chat.vue"],"sourcesContent":["<template>\n  <div class=\"Chat-container\" @click=\"closePopover\">\n    <el-input v-model=\"recText\"  id=\"textarea_id\" :rows=\"row\" type=\"textarea\" style=\"font-size: 17px;\n    user-select: none;-webkit-user-select: auto\" readonly placeholder=\"ËøòÊ≤°Êúâ‰∫∫ËÅäÂ§©...\" />\n\n\n    <el-popover\n        ref=\"popverRef\"\n        trigger=\"click\"\n        v-model=\"visible\">\n      <!-- Ëß¶Âèë‰∫ã‰ª∂ -->\n\n      <!-- ÂºπÊ°ÜÂÜÖÂÆπ -->\n      <div class=\"div_content\" style=\"position: absolute;bottom: 1px\" @click.stop=\"noclosePopover\">\n        <VEmojiPicker @select=\"selectEmoji\" />\n      </div>\n    </el-popover>\n    <el-input  id=\"emojiInput\" v-model=\"sendText\" placeholder=\"ËØ∑ËæìÂÖ•ÂÜÖÂÆπ\" maxlength=\"64\"  class=\"input-with-select\"  @keyup.enter.native=\"$emit('chatEvent',sendText);sendText=''\">\n      <el-button slot=\"prepend\" size=\"mini\"  @click.stop=\"togglePopover\">üòä</el-button>\n      <el-button slot=\"append\" size=\"mini\" icon=\"el-icon-s-promotion\"\n                 @click=\"$emit('chatEvent',sendText);sendText=''\"  />\n    </el-input>\n\n\n  </div>\n</template>\n\n<script>\n\n\nimport { VEmojiPicker } from 'v-emoji-picker';\n\nexport default {\n  name: 'Chat',\n  components: {\n    VEmojiPicker\n  },\n  props: {\n    someData: {\n      type: Object,\n      default: \"\",\n    },\n    client: {\n      type: Object,\n      default: null\n    },\n    receiveMsg: {\n      type: String,\n      require: false,\n      default: ''\n    }\n  },\ncreated(){\n        this.request.get(\"/message/getMsg/\", {\n          params: {\n            meetingId:this.someData.meetingId\n          }\n        }).then(res => {\n          if (res.code===\"200\"){\n            let Msgdata=[]\n            for (let i=0;i<res.data.length;i++)\n            {\n              // if (i===res.data.length-1){\n              // Msgdata[i]=res.data[i].nickname+\":\"+ res.data[i].content}\n              // else {\n                Msgdata[i]=res.data[i].nickname+\":\"+ res.data[i].content+\"\\n\"\n              // }\n\n            }\n            Msgdata = Msgdata.toString().replace(/,/g, \"\");\n            this.recText= Msgdata\n            this.scrollBottom();\n\n          }\n          else {\n            this.$message.success(\"ËÅäÂ§©ËÆ∞ÂΩïÂá∫ÈîôÂï¶ÔºÅ\")\n          }\n        })\n},\n\n  mounted() {\n    window.addEventListener('click', this.handleOutsideClick);\n    this.getScreenSize();\n    console.log(\"someData\",this.someData)\n\n  },\n  data() {\n    return {\n      visible: false,\n      recText: '',\n      sendText: '',\n      row:'',\n      editor: null,\n      screenWidth: '',\n      screenHeight: '',\n      toolbarConfig: { },\n      editorConfig: { placeholder: 'ËØ∑ËæìÂÖ•ÂÜÖÂÆπ...' },\n      mode: 'default', // or 'simple'\n    }\n  },\n\n  watch: {\n    receiveMsg: {\n      handler(newVal) {\n        this.receiveMsgHandle(newVal);\n      },\n      immediate: true,\n      deep: true\n    }\n  },\n\n  methods: {\n    getScreenSize() {\n      this.screenWidth = document.body.clientWidth;\n      this.screenHeight = document.body.clientHeight\n      window.onresize = () => {\n        return (() => {\n          this.screenWidth = document.body.clientWidth;\n          this.screenHeight = document.body.clientHeight;\n          if (this.screenHeight>900) {\n            this.row=21\n          }\n          else {\n            this.row=15\n          }\n        })();\n      };\n\n      if (this.screenHeight>900) {\n        this.row=21\n      }\n      else {\n        this.row=15\n      }\n    },\n    scrollBottom(){\n    this.$nextTick(() => {\n      setTimeout(() => {\n        const textarea = document.getElementById('textarea_id');\n        textarea.scrollTop = textarea.scrollHeight;\n      }, 13)\n    })\n  },\n\n    handleOutsideClick(event) {\n      // Ëé∑ÂèñÁªÑ‰ª∂ÁöÑÊ†πÂÖÉÁ¥†\n      const container = this.$el;\n      // Âà§Êñ≠ÁÇπÂáª‰∫ã‰ª∂ÁöÑÁõÆÊ†áÊòØÂê¶Âú®ÁªÑ‰ª∂‰ª•Â§ñ\n      if (!container.contains(event.target)) {\n        this.closePopover();\n      }\n    },\n    closePopover() {\n      this.visible = false;\n    },\n    togglePopover() {\n      this.visible = !this.visible;\n    },\n    noclosePopover() {\n      this.visible = true;\n    },\n    selectEmoji(emoji) {\n      console.log(emoji)\n      var elInput = document.getElementById('emojiInput')//Ëé∑ÂèñËæìÂÖ•Ê°ÜÂÖÉÁ¥†\n      // console.log(elInput);\n      var start = elInput.selectionStart // ËÆ∞ÂΩïÂÖâÊ†áÂºÄÂßãÁöÑ‰ΩçÁΩÆ\n      var end = elInput.selectionEnd // ËÆ∞ÂΩïÈÄâ‰∏≠ÁöÑÂ≠óÁ¨¶ ÊúÄÂêéÁöÑÂ≠óÁ¨¶ÁöÑ‰ΩçÁΩÆ\n      if (start === undefined || end === undefined) return\n      var txt = elInput.value\n      // Â∞ÜË°®ÊÉÖÊ∑ªÂä†Âà∞ÈÄâ‰∏≠ÁöÑÂÖâÊ†á‰ΩçÁΩÆ\n      var result =\n          txt.substring(0, start) + emoji.data + txt.substring(end)\n      elInput.value = result // ËµãÂÄºÁªôinputÁöÑvalue\n      // ÈáçÁΩÆÂÖâÊ†á‰ΩçÁΩÆ\n      elInput.focus()\n      elInput.selectionStart = start + emoji.data.length\n      elInput.selectionEnd = start + emoji.data.length\n      console.log(result)\n      this.sendText= result // ËµãÂÄº(Ê≥®ÊÑèËøôÈáå‰∏ÄÂÆöË¶ÅËµãÂÄºÁªôË°®ÊÉÖËæìÂÖ•Ê°ÜÁªëÂÆöÁöÑÈÇ£‰∏™ÂÄº)\n\n    },\n    receiveMsgHandle(newVal) {\n      if (newVal && newVal.content) {\n        this.recText += newVal.content;\n        this.scrollBottom();\n      }\n    },\n    enterSearch(){\n      document.onkeydown = e =>{\n        //13Ë°®‚Ω∞ÂõûËΩ¶ÈîÆÔºåbaseURIÊòØÂΩìÂâçÈ°µ‚æØÁöÑÂú∞ÂùÄÔºå‰∏∫‰∫ÜÊõ¥‰∏•Ë∞®Ôºå‰πüÂèØ‰ª•Âä†Âà´ÁöÑÔºåÂèØ‰ª•ÊâìÂç∞eÁúã‚ºÄ‰∏ã\n          //ÂõûËΩ¶ÂêéÊâß‚æèÊêúÁ¥¢‚ΩÖÊ≥ï\n\n          this.$emit('chatEvent', this.sendText)\n\n      }\n    },\n\n\n  }\n}\n</script>\n\n\n\n<style lang=\"scss\" scoped>\n::v-deep .el-popover{\n  padding: 0;\n\n}\n.textarea_id{\n  resize:none;\n  -webkit-user-select:auto; /*webkitÊµèËßàÂô®*/\n}\n\n\n::v-deep .el-textarea__inner {\n  resize:none;\n  overflow-y: hidden;\n  /*ÂÆö‰πâÊªöÂä®Êù°ÂÆΩÈ´òÂèäËÉåÊôØÔºåÂÆΩÈ´òÂàÜÂà´ÂØπÂ∫îÊ®™Á´ñÊªöÂä®Êù°ÁöÑÂ∞∫ÂØ∏*/\n  // ÊªöÂä®Êù°Êï¥‰ΩìÈÉ®ÂàÜ\n  &::-webkit-scrollbar {\n    width: 6px;\n    height: 6px;\n  }\n  // ÊªöÂä®Êù°ÁöÑËΩ®ÈÅìÁöÑ‰∏§Á´ØÊåâÈíÆÔºåÂÖÅËÆ∏ÈÄöËøáÁÇπÂáªÂæÆË∞ÉÂ∞èÊñπÂùóÁöÑ‰ΩçÁΩÆ„ÄÇ\n  &::-webkit-scrollbar-button {\n    display: none;\n  }\n  // ÊªöÂä®Êù°ÈáåÈù¢ÁöÑÂ∞èÊñπÂùóÔºåËÉΩÂêë‰∏äÂêë‰∏ãÁßªÂä®ÔºàÊàñÂæÄÂ∑¶ÂæÄÂè≥ÁßªÂä®ÔºåÂèñÂÜ≥‰∫éÊòØÂûÇÁõ¥ÊªöÂä®Êù°ËøòÊòØÊ∞¥Âπ≥ÊªöÂä®Êù°Ôºâ\n  &::-webkit-scrollbar-thumb {\n    background: rgba(144, 147, 153, 0.3);\n    cursor: pointer;\n    border-radius: 4px;\n  }\n  // ËæπËßíÔºåÂç≥‰∏§‰∏™ÊªöÂä®Êù°ÁöÑ‰∫§Ê±áÂ§Ñ\n  &::-webkit-scrollbar-corner {\n    display: none;\n  }\n  // ‰∏§‰∏™ÊªöÂä®Êù°ÁöÑ‰∫§Ê±áÂ§Ñ‰∏äÁî®‰∫éÈÄöËøáÊãñÂä®Ë∞ÉÊï¥ÂÖÉÁ¥†Â§ßÂ∞èÁöÑÂ∞èÊéß‰ª∂\n  &::-webkit-resizer {\n    display: none;\n  }\n\n}\n::v-deep .el-textarea__inner:corner-present{\n  scrollbar-width: none;\n}\n::v-deep .el-textarea__inner:hover{\n  overflow-y: auto;\n  /*ÂÆö‰πâÊªöÂä®Êù°ÂÆΩÈ´òÂèäËÉåÊôØÔºåÂÆΩÈ´òÂàÜÂà´ÂØπÂ∫îÊ®™Á´ñÊªöÂä®Êù°ÁöÑÂ∞∫ÂØ∏*/\n  scrollbar-width: thin;\n  scrollbar-color: #999999 #f0f0f0;\n\n\n  // ÊªöÂä®Êù°Êï¥‰ΩìÈÉ®ÂàÜ\n  &::-webkit-scrollbar {\n    width: 6px;\n    height: 6px;\n  }\n  // ÊªöÂä®Êù°ÁöÑËΩ®ÈÅìÁöÑ‰∏§Á´ØÊåâÈíÆÔºåÂÖÅËÆ∏ÈÄöËøáÁÇπÂáªÂæÆË∞ÉÂ∞èÊñπÂùóÁöÑ‰ΩçÁΩÆ„ÄÇ\n  &::-webkit-scrollbar-button {\n    display: none;\n  }\n  // ÊªöÂä®Êù°ÈáåÈù¢ÁöÑÂ∞èÊñπÂùóÔºåËÉΩÂêë‰∏äÂêë‰∏ãÁßªÂä®ÔºàÊàñÂæÄÂ∑¶ÂæÄÂè≥ÁßªÂä®ÔºåÂèñÂÜ≥‰∫éÊòØÂûÇÁõ¥ÊªöÂä®Êù°ËøòÊòØÊ∞¥Âπ≥ÊªöÂä®Êù°Ôºâ\n  &::-webkit-scrollbar-thumb {\n    background: rgba(144, 147, 153, 0.3);\n    cursor: pointer;\n    border-radius: 4px;\n  }\n  // ËæπËßíÔºåÂç≥‰∏§‰∏™ÊªöÂä®Êù°ÁöÑ‰∫§Ê±áÂ§Ñ\n  &::-webkit-scrollbar-corner {\n    display: none;\n  }\n  // ‰∏§‰∏™ÊªöÂä®Êù°ÁöÑ‰∫§Ê±áÂ§Ñ‰∏äÁî®‰∫éÈÄöËøáÊãñÂä®Ë∞ÉÊï¥ÂÖÉÁ¥†Â§ßÂ∞èÁöÑÂ∞èÊéß‰ª∂\n  &::-webkit-resizer {\n    display: none;\n  }\n}\n\n</style>\n"]},"metadata":{},"sourceType":"module"}
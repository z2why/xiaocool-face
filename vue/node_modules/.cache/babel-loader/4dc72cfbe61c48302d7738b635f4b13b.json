{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { VEmojiPicker } from 'v-emoji-picker';\nexport default {\n  name: 'Chat',\n  components: {\n    VEmojiPicker\n  },\n  props: {\n    someData: {\n      type: Number,\n      default: \"\"\n    },\n    client: {\n      type: Object,\n      default: null\n    },\n    receiveMsg: {\n      type: String,\n      require: false,\n      default: ''\n    }\n  },\n\n  created() {\n    this.request.get(\"/message/getMsg/\" + {\n      meetingId: this.someData.meetingId\n    }).then(res => {\n      if (res.code === '200') {\n        this.$message.success(\"ok!\");\n      }\n    });\n  },\n\n  mounted() {\n    window.addEventListener('click', this.handleOutsideClick);\n  },\n\n  data() {\n    return {\n      visible: false,\n      recText: '',\n      sendText: '',\n      editor: null,\n      toolbarConfig: {},\n      editorConfig: {\n        placeholder: 'è¯·è¾“å…¥å†…å®¹...'\n      },\n      mode: 'default' // or 'simple'\n\n    };\n  },\n\n  watch: {\n    receiveMsg() {\n      this.receiveMsgHandle();\n    }\n\n  },\n  methods: {\n    handleOutsideClick(event) {\n      // è·å–ç»„ä»¶çš„æ ¹å…ƒç´ \n      const container = this.$el; // åˆ¤æ–­ç‚¹å‡»äº‹ä»¶çš„ç›®æ ‡æ˜¯å¦åœ¨ç»„ä»¶ä»¥å¤–\n\n      if (!container.contains(event.target)) {\n        this.closePopover();\n      }\n    },\n\n    closePopover() {\n      this.visible = false;\n    },\n\n    togglePopover() {\n      this.visible = !this.visible;\n    },\n\n    noclosePopover() {\n      this.visible = true;\n    },\n\n    selectEmoji(emoji) {\n      console.log(emoji);\n      var elInput = document.getElementById('emojiInput'); //è·å–è¾“å…¥æ¡†å…ƒç´ \n      // console.log(elInput);\n\n      var start = elInput.selectionStart; // è®°å½•å…‰æ ‡å¼€å§‹çš„ä½ç½®\n\n      var end = elInput.selectionEnd; // è®°å½•é€‰ä¸­çš„å­—ç¬¦ æœ€åçš„å­—ç¬¦çš„ä½ç½®\n\n      if (start === undefined || end === undefined) return;\n      var txt = elInput.value; // å°†è¡¨æƒ…æ·»åŠ åˆ°é€‰ä¸­çš„å…‰æ ‡ä½ç½®\n\n      var result = txt.substring(0, start) + emoji.data + txt.substring(end);\n      elInput.value = result; // èµ‹å€¼ç»™inputçš„value\n      // é‡ç½®å…‰æ ‡ä½ç½®\n\n      elInput.focus();\n      elInput.selectionStart = start + emoji.data.length;\n      elInput.selectionEnd = start + emoji.data.length;\n      console.log(result);\n      this.sendText = result; // èµ‹å€¼(æ³¨æ„è¿™é‡Œä¸€å®šè¦èµ‹å€¼ç»™è¡¨æƒ…è¾“å…¥æ¡†ç»‘å®šçš„é‚£ä¸ªå€¼)\n    },\n\n    receiveMsgHandle() {\n      this.recText += this.receiveMsg;\n    },\n\n    enterSearch() {\n      document.onkeydown = e => {\n        //13è¡¨â½°å›è½¦é”®ï¼ŒbaseURIæ˜¯å½“å‰é¡µâ¾¯çš„åœ°å€ï¼Œä¸ºäº†æ›´ä¸¥è°¨ï¼Œä¹Ÿå¯ä»¥åŠ åˆ«çš„ï¼Œå¯ä»¥æ‰“å°eçœ‹â¼€ä¸‹\n        //å›è½¦åæ‰§â¾æœç´¢â½…æ³•\n        this.$emit('chatEvent', this.sendText);\n      };\n    }\n\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AAEA;EACAA,YADA;EAEAC;IACAC;EADA,CAFA;EAKAC;IACAC;MACAC,YADA;MAEAC;IAFA,CADA;IAKAC;MACAF,YADA;MAEAC;IAFA,CALA;IASAE;MACAH,YADA;MAEAI,cAFA;MAGAH;IAHA;EATA,CALA;;EAoBAI;IACA;MAAAC;IAAA;MACA;QACA;MACA;IAEA,CALA;EAQA,CA7BA;;EAiCAC;IACAC;EACA,CAnCA;;EAoCAC;IACA;MACAC,cADA;MAEAC,WAFA;MAGAC,YAHA;MAIAC,YAJA;MAKAC,iBALA;MAMAC;QAAAC;MAAA,CANA;MAOAC,eAPA,CAOA;;IAPA;EASA,CA9CA;;EA+CAC;IACAf;MACA;IACA;;EAHA,CA/CA;EAqDAgB;IACAC;MACA;MACA,2BAFA,CAIA;;MACA;QACA;MACA;IACA,CATA;;IAUAC;MACA;IACA,CAZA;;IAaAC;MACA;IACA,CAfA;;IAgBAC;MACA;IACA,CAlBA;;IAmBAC;MACAC;MACA,oDAFA,CAEA;MACA;;MACA,mCAJA,CAIA;;MACA,+BALA,CAKA;;MACA;MACA,wBAPA,CAQA;;MACA,aACAC,yDADA;MAEAC,uBAXA,CAWA;MACA;;MACAA;MACAA;MACAA;MACAF;MACA,uBAjBA,CAiBA;IAEA,CAtCA;;IAuCAG;MACA;IACA,CAzCA;;IA0CAC;MACAC;QACA;QACA;QAEA;MAEA,CANA;IAOA;;EAlDA;AArDA","names":["name","components","VEmojiPicker","props","someData","type","default","client","receiveMsg","require","created","meetingId","mounted","window","data","visible","recText","sendText","editor","toolbarConfig","editorConfig","placeholder","mode","watch","methods","handleOutsideClick","closePopover","togglePopover","noclosePopover","selectEmoji","console","txt","elInput","receiveMsgHandle","enterSearch","document"],"sourceRoot":"src/views/meeting/components","sources":["Chat.vue"],"sourcesContent":["<template>\n  <div class=\"Chat-container\" @click=\"closePopover\">\n    <el-input v-model=\"recText\"  :rows=\"18.5\"  type=\"textarea\" style=\"font-size: large;user-select: none;-webkit-user-select: auto\" readonly placeholder=\"è¿˜æ²¡æœ‰äººèŠå¤©...\" />\n    <el-popover\n        ref=\"popverRef\"\n        trigger=\"click\"\n        v-model=\"visible\"\n    >\n      <!-- è§¦å‘äº‹ä»¶ -->\n\n      <!-- å¼¹æ¡†å†…å®¹ -->\n      <div class=\"div_content\" style=\"position: absolute;bottom: 1px\" @click.stop=\"noclosePopover\">\n        <VEmojiPicker @select=\"selectEmoji\" />\n      </div>\n    </el-popover>\n<!--    <el-button   slot=\"prepend\" type=\"text\" size=\"mini\"  @click=\"visible = !visible\">ğŸ˜Š</el-button>-->\n    <el-input  id=\"emojiInput\" v-model=\"sendText\" placeholder=\"è¯·è¾“å…¥å†…å®¹\" maxlength=\"64\"  class=\"input-with-select\"  @keyup.enter.native=\"$emit('chatEvent',sendText);sendText=''\">\n      <el-button slot=\"prepend\" size=\"mini\"  @click.stop=\"togglePopover\">ğŸ˜Š</el-button>\n      <el-button slot=\"append\" size=\"mini\" icon=\"el-icon-s-promotion\"\n                 @click=\"$emit('chatEvent',sendText);sendText=''\"  />\n    </el-input>\n\n\n  </div>\n</template>\n\n<script>\n\n\nimport { VEmojiPicker } from 'v-emoji-picker';\n\nexport default {\n  name: 'Chat',\n  components: {\n    VEmojiPicker\n  },\n  props: {\n    someData: {\n      type: Number,\n      default: \"\",\n    },\n    client: {\n      type: Object,\n      default: null\n    },\n    receiveMsg: {\n      type: String,\n      require: false,\n      default: ''\n    }\n  },\ncreated(){\n        this.request.get(\"/message/getMsg/\"+{meetingId:this.someData.meetingId}).then(res => {\n        if (res.code === '200') {\n          this.$message.success(\"ok!\")\n        }\n\n  })\n\n\n},\n\n\n\n  mounted() {\n    window.addEventListener('click', this.handleOutsideClick);\n  },\n  data() {\n    return {\n      visible: false,\n      recText: '',\n      sendText: '',\n      editor: null,\n      toolbarConfig: { },\n      editorConfig: { placeholder: 'è¯·è¾“å…¥å†…å®¹...' },\n      mode: 'default', // or 'simple'\n    }\n  },\n  watch: {\n    receiveMsg() {\n      this.receiveMsgHandle()\n    }\n  },\n\n  methods: {\n    handleOutsideClick(event) {\n      // è·å–ç»„ä»¶çš„æ ¹å…ƒç´ \n      const container = this.$el;\n\n      // åˆ¤æ–­ç‚¹å‡»äº‹ä»¶çš„ç›®æ ‡æ˜¯å¦åœ¨ç»„ä»¶ä»¥å¤–\n      if (!container.contains(event.target)) {\n        this.closePopover();\n      }\n    },\n    closePopover() {\n      this.visible = false;\n    },\n    togglePopover() {\n      this.visible = !this.visible;\n    },\n    noclosePopover() {\n      this.visible = true;\n    },\n    selectEmoji(emoji) {\n      console.log(emoji)\n      var elInput = document.getElementById('emojiInput')//è·å–è¾“å…¥æ¡†å…ƒç´ \n      // console.log(elInput);\n      var start = elInput.selectionStart // è®°å½•å…‰æ ‡å¼€å§‹çš„ä½ç½®\n      var end = elInput.selectionEnd // è®°å½•é€‰ä¸­çš„å­—ç¬¦ æœ€åçš„å­—ç¬¦çš„ä½ç½®\n      if (start === undefined || end === undefined) return\n      var txt = elInput.value\n      // å°†è¡¨æƒ…æ·»åŠ åˆ°é€‰ä¸­çš„å…‰æ ‡ä½ç½®\n      var result =\n          txt.substring(0, start) + emoji.data + txt.substring(end)\n      elInput.value = result // èµ‹å€¼ç»™inputçš„value\n      // é‡ç½®å…‰æ ‡ä½ç½®\n      elInput.focus()\n      elInput.selectionStart = start + emoji.data.length\n      elInput.selectionEnd = start + emoji.data.length\n      console.log(result)\n      this.sendText= result // èµ‹å€¼(æ³¨æ„è¿™é‡Œä¸€å®šè¦èµ‹å€¼ç»™è¡¨æƒ…è¾“å…¥æ¡†ç»‘å®šçš„é‚£ä¸ªå€¼)\n\n    },\n    receiveMsgHandle() {\n      this.recText += this.receiveMsg\n    },\n    enterSearch(){\n      document.onkeydown = e =>{\n        //13è¡¨â½°å›è½¦é”®ï¼ŒbaseURIæ˜¯å½“å‰é¡µâ¾¯çš„åœ°å€ï¼Œä¸ºäº†æ›´ä¸¥è°¨ï¼Œä¹Ÿå¯ä»¥åŠ åˆ«çš„ï¼Œå¯ä»¥æ‰“å°eçœ‹â¼€ä¸‹\n          //å›è½¦åæ‰§â¾æœç´¢â½…æ³•\n\n          this.$emit('chatEvent', this.sendText)\n\n      }\n    },\n\n\n  }\n}\n</script>\n\n\n\n<style lang=\"scss\" scoped>\n::v-deep .el-popover{\n  padding: 0;\n\n}\ntextarea{\n\n  -webkit-user-select:auto; /*webkitæµè§ˆå™¨*/\n\n}\n\n</style>\n"]},"metadata":{},"sourceType":"module"}